# Model of Gates Network
# June, 2015

import re
import sys

# Mininet imports
from mininet.log import lg, info, error, debug, output
from mininet.util import quietRun
from mininet.node import Host, OVSSwitch, RemoteController
from mininet.cli import CLI
from mininet.net import Mininet

def start(ip="127.0.0.1",port=6633):

    ctrlr = lambda n: RemoteController(n, ip=ip, port=port, inNamespace=False)
    net = Mininet(switch=OVSSwitch, controller=ctrlr, autoStaticArp=False, listenPort=6634)
    c1 = net.addController('c1')

    ####### End of static Mininet prologue ######

    s1 = net.addSwitch('s1')
    s2 = net.addSwitch('s2')
    s3 = net.addSwitch('s3')
    s4 = net.addSwitch('s4')
    s5 = net.addSwitch('s5')
    s6 = net.addSwitch('s6')
    s7 = net.addSwitch('s7')
    s8 = net.addSwitch('s8')
    s9 = net.addSwitch('s9')
    s10 = net.addSwitch('s10')
    s11 = net.addSwitch('s11')
    s12 = net.addSwitch('s12')
    s13 = net.addSwitch('s13')
    s14 = net.addSwitch('s14')
    s15 = net.addSwitch('s15')
    s16 = net.addSwitch('s16')
    s17 = net.addSwitch('s17')
    s18 = net.addSwitch('s18')
    s19 = net.addSwitch('s19')
    s20 = net.addSwitch('s20')
    s21 = net.addSwitch('s21')
    s22 = net.addSwitch('s22')
    s23 = net.addSwitch('s23')
    s24 = net.addSwitch('s24')
    s25 = net.addSwitch('s25')
    s26 = net.addSwitch('s26')
    s27 = net.addSwitch('s27')
    s28 = net.addSwitch('s28')
    h1 = net.addHost('h1', mac='00:00:01:00:00:11', ip='10.0.0.101')
    h2 = net.addHost('h2', mac='00:00:01:00:00:12', ip='10.0.0.102')
    h3 = net.addHost('h3', mac='00:00:01:00:00:13', ip='10.0.0.103')
    h4 = net.addHost('h4', mac='00:00:01:00:00:14', ip='10.0.0.104')
    h5 = net.addHost('h5', mac='00:00:01:00:00:15', ip='10.0.0.105')
    h6 = net.addHost('h6', mac='00:00:01:00:00:16', ip='10.0.0.106')
    h7 = net.addHost('h7', mac='00:00:01:00:00:17', ip='10.0.0.107')
    h8 = net.addHost('h8', mac='00:00:01:00:00:18', ip='10.0.0.108')
    h9 = net.addHost('h9', mac='00:00:01:00:00:19', ip='10.0.0.109')
    h10 = net.addHost('h10', mac='00:00:01:00:00:20', ip='10.0.0.110')
    h11 = net.addHost('h11', mac='00:00:01:00:00:21', ip='10.0.0.111')
    h12 = net.addHost('h12', mac='00:00:01:00:00:22', ip='10.0.0.112')
    h13 = net.addHost('h13', mac='00:00:01:00:00:23', ip='10.0.0.113')
    h14 = net.addHost('h14', mac='00:00:01:00:00:24', ip='10.0.0.114')
    h15 = net.addHost('h15', mac='00:00:01:00:00:25', ip='10.0.0.115')
    h16 = net.addHost('h16', mac='00:00:01:00:00:26', ip='10.0.0.116')
    h17 = net.addHost('h17', mac='00:00:01:00:00:27', ip='10.0.0.117')
    h18 = net.addHost('h18', mac='00:00:01:00:00:28', ip='10.0.0.118')
    h19 = net.addHost('h19', mac='00:00:01:00:00:29', ip='10.0.0.119')
    h20 = net.addHost('h20', mac='00:00:01:00:00:30', ip='10.0.0.120')
    h21 = net.addHost('h21', mac='00:00:01:00:00:31', ip='10.0.0.121')
    h22 = net.addHost('h22', mac='00:00:01:00:00:32', ip='10.0.0.122')
    h23 = net.addHost('h23', mac='00:00:01:00:00:33', ip='10.0.0.123')
    h24 = net.addHost('h24', mac='00:00:01:00:00:34', ip='10.0.0.124')
    h25 = net.addHost('h25', mac='00:00:01:00:00:35', ip='10.0.0.125')
    h26 = net.addHost('h26', mac='00:00:01:00:00:36', ip='10.0.0.126')
    h27 = net.addHost('h27', mac='00:00:01:00:00:37', ip='10.0.0.127')
    h28 = net.addHost('h28', mac='00:00:01:00:00:38', ip='10.0.0.128')
    net.addLink(s1, s7, 1, 6)
    net.addLink(s1, h1, 2, 0)
    net.addLink(s2, s7, 1, 5)
    net.addLink(s2, h2, 2, 0)
    net.addLink(s3, s7, 1, 1)
    net.addLink(s3, h3, 2, 0)
    net.addLink(s4, s6, 5, 1)
    net.addLink(s4, s10, 1, 1)
    net.addLink(s4, s16, 4, 1)
    net.addLink(s4, s21, 2, 1)
    net.addLink(s4, s22, 7, 1)
    net.addLink(s4, s24, 3, 1)
    net.addLink(s4, s28, 6, 4)
    net.addLink(s4, h4, 8, 0)
    net.addLink(s5, s28, 1, 1)
    net.addLink(s5, h5, 2, 0)
    net.addLink(s6, h6, 2, 0)
    net.addLink(s7, s8, 12, 1)
    net.addLink(s7, s11, 7, 1)
    net.addLink(s7, s12, 3, 1)
    net.addLink(s7, s14, 2, 1)
    net.addLink(s7, s17, 9, 1)
    net.addLink(s7, s18, 8, 1)
    net.addLink(s7, s19, 11, 1)
    net.addLink(s7, s20, 10, 1)
    net.addLink(s7, s25, 13, 1)
    net.addLink(s7, s26, 4, 1)
    net.addLink(s7, s28, 14, 7)
    net.addLink(s7, h7, 15, 0)
    net.addLink(s8, h8, 2, 0)
    net.addLink(s9, s28, 1, 2)
    net.addLink(s9, h9, 2, 0)
    net.addLink(s10, h10, 2, 0)
    net.addLink(s11, h11, 2, 0)
    net.addLink(s12, h12, 2, 0)
    net.addLink(s13, s28, 1, 6)
    net.addLink(s13, h13, 2, 0)
    net.addLink(s14, h14, 2, 0)
    net.addLink(s15, s23, 1, 1)
    net.addLink(s15, s28, 2, 5)
    net.addLink(s15, h15, 3, 0)
    net.addLink(s16, h16, 2, 0)
    net.addLink(s17, h17, 2, 0)
    net.addLink(s18, h18, 2, 0)
    net.addLink(s19, h19, 2, 0)
    net.addLink(s20, h20, 2, 0)
    net.addLink(s21, h21, 2, 0)
    net.addLink(s22, h22, 2, 0)
    net.addLink(s23, h23, 2, 0)
    net.addLink(s24, h24, 2, 0)
    net.addLink(s25, h25, 2, 0)
    net.addLink(s26, h26, 2, 0)
    net.addLink(s27, s28, 1, 3)
    net.addLink(s27, h27, 2, 0)
    net.addLink(s28, h28, 8, 0)

    ###### Start of static Mininet epilogue ######
    # Set up logging etc.
    lg.setLogLevel('info')
    lg.setLogLevel('output')

    # Start the network and prime other ARP caches
    net.start()
    net.staticArp()

    # Enter CLI mode
    output("Network ready\n")
    output("Press Ctrl-d or type exit to quit\n")
    CLI(net)
    net.stop()

start()